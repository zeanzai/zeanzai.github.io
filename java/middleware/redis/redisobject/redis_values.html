<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.38" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://zeanzai.me/java/middleware/redis/redisobject/redis_values.html"><meta property="og:site_name" content="天晴小猪"><meta property="og:title" content="支持的数据类型"><meta property="og:type" content="article"><meta property="og:updated_time" content="2023-08-17T04:43:51.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:tag" content="redis"><meta property="article:modified_time" content="2023-08-17T04:43:51.000Z"><link rel="stylesheet" href="//at.alicdn.com/t/font_2410206_mfj6e1vbwo.css"><title>支持的数据类型 | 天晴小猪</title><meta name="description" content="天晴小猪 | 关于后端与架构设计 | Software Engineer | Backend | JAVA | DevOps | Linux | IDEA | Microservice | 我活在世上，无非想要明白些道理，遇见些有趣的事。倘能如我所愿，我的一生就算成功。">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/assets/style.fac109b7.css">
    <link rel="modulepreload" href="/assets/app.3140fa71.js"><link rel="modulepreload" href="/assets/redis_values.html.a21fb6ad.js"><link rel="modulepreload" href="/assets/redis_values.html.74d403a3.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper.21dcd24c.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc sidebar-open"><!--[--><header class="navbar"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><a href="/" class="home-link"><img class="logo" src="/logo.JPG" alt="天晴小猪"><!----><span class="site-name hide-in-pad">天晴小猪</span><!--[--><!----><!--]--></a><nav class="nav-links" style=""><div class="nav-item hide-in-mobile"><a href="/java/" class="nav-link active" aria-label="Java面试宝典"><i class="icon iconfont icon-java"></i>Java面试宝典<!----></a></div><div class="nav-item hide-in-mobile"><a href="/springcloud-alibaba/" class="nav-link" aria-label="SpringCloud-Alibaba实战"><i class="icon iconfont icon-code"></i>SpringCloud-Alibaba实战<!----></a></div><div class="nav-item hide-in-mobile"><a href="/question/" class="nav-link" aria-label="面试自查宝典"><i class="icon iconfont icon-quote"></i>面试自查宝典<!----></a></div><div class="nav-item hide-in-mobile"><a href="/linux/" class="nav-link" aria-label="开发环境手册"><i class="icon iconfont icon-customize"></i>开发环境手册<!----></a></div><div class="nav-item hide-in-mobile"><a href="/slashteen/" class="nav-link" aria-label="副业之路"><i class="icon iconfont icon-java"></i>副业之路<!----></a></div></nav><div class="nav-actions-wrapper"><!--[--><!----><!--]--><div class="nav-item"><!----></div><div class="nav-item"><a class="repo-link" href="https://github.com/zeanzai/zeanzai.github.io" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" aria-labelledby="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><title id="github" lang="en">github icon</title><g fill="currentColor"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></g></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewbox="0 0 1024 1024" aria-labelledby="auto" style="display:block;"><title id="auto" lang="en">auto icon</title><g fill="currentColor"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></g></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewbox="0 0 1024 1024" aria-labelledby="dark" style="display:none;"><title id="dark" lang="en">dark icon</title><g fill="currentColor"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></g></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewbox="0 0 1024 1024" aria-labelledby="light" style="display:none;"><title id="light" lang="en">light icon</title><g fill="currentColor"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></g></svg></button></div><!----><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button><!--[--><!----><!--]--></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">零、面试前准备</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">一、计算机基础</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">二、JavaCore</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">三、框架</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable active"><!----><span class="title">四、中间件</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">MySQL</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable active"><!----><span class="title">Redis</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/java/middleware/redis/redis-glance.html" class="nav-link sidebar-link sidebar-page" aria-label="单机版部署及可视化操作台"><!---->单机版部署及可视化操作台<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable active"><!----><span class="title">Redis中的对象系统</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/java/middleware/redis/redisobject/redis_value_dsa.html" class="nav-link sidebar-link sidebar-page" aria-label="底层数据结构"><!---->底层数据结构<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="支持的数据类型"><!---->支持的数据类型<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#前言" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="前言"><!---->前言<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#string" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="String"><!---->String<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#保存内容" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="保存内容"><!---->保存内容<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#使用场景" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="使用场景"><!---->使用场景<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#命令示例" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="命令示例"><!---->命令示例<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#底层数据结构" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="底层数据结构"><!---->底层数据结构<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#list" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="List"><!---->List<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#使用场景-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="使用场景"><!---->使用场景<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#命令示例-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="命令示例"><!---->命令示例<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#底层数据结构-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="底层数据结构"><!---->底层数据结构<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#set" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Set"><!---->Set<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#使用场景-2" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="使用场景"><!---->使用场景<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#命令示例-2" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="命令示例"><!---->命令示例<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#底层数据结构-2" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="底层数据结构"><!---->底层数据结构<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#sortedset-zset" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="SortedSet（zset）"><!---->SortedSet（zset）<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#使用场景-3" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="使用场景"><!---->使用场景<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#命令示例-3" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="命令示例"><!---->命令示例<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#底层数据结构-3" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="底层数据结构"><!---->底层数据结构<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#hash" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Hash"><!---->Hash<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#使用场景-4" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="使用场景"><!---->使用场景<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#命令示例-4" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="命令示例"><!---->命令示例<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#底层数据结构-4" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="底层数据结构"><!---->底层数据结构<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#bitmap" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Bitmap"><!---->Bitmap<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#内部实现" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="内部实现"><!---->内部实现<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#适用场景" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="适用场景"><!---->适用场景<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#hyperloglog" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="HyperLogLog"><!---->HyperLogLog<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#命令示例-5" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="命令示例"><!---->命令示例<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#底层数据结构-5" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="底层数据结构"><!---->底层数据结构<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#适用场景-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="适用场景"><!---->适用场景<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#geo" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="GEO"><!---->GEO<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#命令示例-6" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="命令示例"><!---->命令示例<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#底层数据结构-6" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="底层数据结构"><!---->底层数据结构<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#stream" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Stream"><!---->Stream<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#使用redis早期版本作为消息中间件" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="使用Redis早期版本作为消息中间件"><!---->使用Redis早期版本作为消息中间件<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#保存内容-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="保存内容"><!---->保存内容<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#命令示例-7" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="命令示例"><!---->命令示例<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#stream与主流mq对比" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Stream与主流MQ对比"><!---->Stream与主流MQ对比<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li></ul></section><!--]--></li><li><!--[--><a href="/java/middleware/redis/redis-high-character.html" class="nav-link sidebar-link sidebar-page" aria-label="高级特性"><!---->高级特性<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/middleware/redis/memory-management.html" class="nav-link sidebar-link sidebar-page" aria-label="内存淘汰机制与持久化机制"><!---->内存淘汰机制与持久化机制<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/middleware/redis/pro-env.html" class="nav-link sidebar-link sidebar-page" aria-label="生产环境运维"><!---->生产环境运维<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/middleware/redis/pro-problem.html" class="nav-link sidebar-link sidebar-page" aria-label="生产问题及解决方案"><!---->生产问题及解决方案<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li><li><!--[--><a href="/java/middleware/zk.html" class="nav-link sidebar-link sidebar-page" aria-label=" ZooKeeper"><!----> ZooKeeper<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/middleware/mq.html" class="nav-link sidebar-link sidebar-page" aria-label=" MQ"><!----> MQ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">五、分布式</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">六、源码系列</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">七、项目实战</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">八、学习笔记</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">九、工作技巧</span><span class="arrow right"></span></button><!----></section><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->支持的数据类型</h1><div class="page-info"><span class="author-info" aria-label="作者🖊" data-balloon-pos="down" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewbox="0 0 1024 1024" aria-labelledby="author"><title id="author" lang="en">author icon</title><g fill="currentColor"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></g></svg><span><a class="author-item" href="https://zeanzai.me" target="_blank" rel="noopener noreferrer">天晴小猪</a></span><span property="author" content="天晴小猪"></span></span><!----><span class="date-info" aria-label="写作日期📅" data-balloon-pos="down" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewbox="0 0 1024 1024" aria-labelledby="calendar"><title id="calendar" lang="en">calendar icon</title><g fill="currentColor"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></g></svg><span>2023年8月17日</span><meta property="datePublished" content="2023-08-17T04:43:51.000Z"></span><span class="category-info" aria-label="分类🌈" data-balloon-pos="down" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewbox="0 0 1024 1024" aria-labelledby="category"><title id="category" lang="en">category icon</title><g fill="currentColor"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></g></svg><ul class="categories-wrapper"><li class="category category5 clickable" role="navigation">redis</li><meta property="articleSection" content="redis"></ul></span><span aria-label="标签🏷" data-balloon-pos="down" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewbox="0 0 1024 1024" aria-labelledby="tag"><title id="tag" lang="en">tag icon</title><g fill="currentColor"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></g></svg><ul class="tags-wrapper"><li class="tag tag5 clickable" role="navigation">redis</li></ul><meta property="keywords" content="redis"></span><span class="reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewbox="0 0 1024 1024" aria-labelledby="timer"><title id="timer" lang="en">timer icon</title><g fill="currentColor"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></g></svg><span>大约 20 分钟</span><meta property="timeRequired" content="PT20M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc-list"><div class="toc-header">此页内容</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#前言" class="router-link-active router-link-exact-active toc-link level2">前言</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#string" class="router-link-active router-link-exact-active toc-link level2">String</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#保存内容" class="router-link-active router-link-exact-active toc-link level3">保存内容</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#使用场景" class="router-link-active router-link-exact-active toc-link level3">使用场景</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#命令示例" class="router-link-active router-link-exact-active toc-link level3">命令示例</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#底层数据结构" class="router-link-active router-link-exact-active toc-link level3">底层数据结构</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#list" class="router-link-active router-link-exact-active toc-link level2">List</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#使用场景-1" class="router-link-active router-link-exact-active toc-link level3">使用场景</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#命令示例-1" class="router-link-active router-link-exact-active toc-link level3">命令示例</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#底层数据结构-1" class="router-link-active router-link-exact-active toc-link level3">底层数据结构</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#set" class="router-link-active router-link-exact-active toc-link level2">Set</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#使用场景-2" class="router-link-active router-link-exact-active toc-link level3">使用场景</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#命令示例-2" class="router-link-active router-link-exact-active toc-link level3">命令示例</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#底层数据结构-2" class="router-link-active router-link-exact-active toc-link level3">底层数据结构</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#sortedset-zset" class="router-link-active router-link-exact-active toc-link level2">SortedSet（zset）</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#使用场景-3" class="router-link-active router-link-exact-active toc-link level3">使用场景</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#命令示例-3" class="router-link-active router-link-exact-active toc-link level3">命令示例</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#底层数据结构-3" class="router-link-active router-link-exact-active toc-link level3">底层数据结构</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#hash" class="router-link-active router-link-exact-active toc-link level2">Hash</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#使用场景-4" class="router-link-active router-link-exact-active toc-link level3">使用场景</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#命令示例-4" class="router-link-active router-link-exact-active toc-link level3">命令示例</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#底层数据结构-4" class="router-link-active router-link-exact-active toc-link level3">底层数据结构</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#bitmap" class="router-link-active router-link-exact-active toc-link level2">Bitmap</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#内部实现" class="router-link-active router-link-exact-active toc-link level3">内部实现</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#适用场景" class="router-link-active router-link-exact-active toc-link level3">适用场景</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#hyperloglog" class="router-link-active router-link-exact-active toc-link level2">HyperLogLog</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#命令示例-5" class="router-link-active router-link-exact-active toc-link level3">命令示例</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#底层数据结构-5" class="router-link-active router-link-exact-active toc-link level3">底层数据结构</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#适用场景-1" class="router-link-active router-link-exact-active toc-link level3">适用场景</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#geo" class="router-link-active router-link-exact-active toc-link level2">GEO</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#命令示例-6" class="router-link-active router-link-exact-active toc-link level3">命令示例</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#底层数据结构-6" class="router-link-active router-link-exact-active toc-link level3">底层数据结构</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#stream" class="router-link-active router-link-exact-active toc-link level2">Stream</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#使用redis早期版本作为消息中间件" class="router-link-active router-link-exact-active toc-link level3">使用Redis早期版本作为消息中间件</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#保存内容-1" class="router-link-active router-link-exact-active toc-link level3">保存内容</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#命令示例-7" class="router-link-active router-link-exact-active toc-link level3">命令示例</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/middleware/redis/redisobject/redis_values.html#stream与主流mq对比" class="router-link-active router-link-exact-active toc-link level3">Stream与主流MQ对比</a></li><!----><!--]--></ul><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><!--[--><blockquote><p>这里，我们介绍一下Redis<code>值对象</code>所支持的数据类型。所谓<code>值对象</code>所支持的数据类型，是从业务角度来讲的，如String，是指使用Redis的业务，需要保存到Redis中的数据的类型为String，而不是指别的其他。同理List，是指使用Redis的业务场景中，保存到Redis的数据的数据类型是List，也不是指其他。</p><p>说白了，<code>键对象</code>就是一个字符串，相当于对保存的值起了个名字。</p><p>读者要对这一点很清楚。</p></blockquote><h2 id="前言" tabindex="-1"><a class="header-anchor" href="#前言" aria-hidden="true">#</a> 前言</h2><p>3.2版本是一个重要的稳定版本，有很多的更新，详见<a href="http://antirez.com/news/104" target="_blank" rel="noopener noreferrer">这里<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>。</p><p>目前已知的可以支持的数据类型有： String 、 List 、 Set 、 Zset 、 GEO 、 HyperLogLog 、 Stream 等几种数据类型。</p><p>在学习本章节时，要了解一种值对象的应用场景、使用方法（如何用的问题）、内部数据结构（数据结构及转化条件）。</p><h2 id="string" tabindex="-1"><a class="header-anchor" href="#string" aria-hidden="true">#</a> String</h2><h3 id="保存内容" tabindex="-1"><a class="header-anchor" href="#保存内容" aria-hidden="true">#</a> 保存内容</h3><ul><li>字符串存储</li><li>数字</li></ul><h3 id="使用场景" tabindex="-1"><a class="header-anchor" href="#使用场景" aria-hidden="true">#</a> 使用场景</h3><ul><li>任何需要存储字符串的场景都可以</li><li>特殊场景：页面存储、session集中式存储、数字运算等</li></ul><h3 id="命令示例" tabindex="-1"><a class="header-anchor" href="#命令示例" aria-hidden="true">#</a> 命令示例</h3><ul><li>CLI命令 <ul><li>单键操作 <ul><li>get</li><li>getrange</li><li>getset</li><li>set</li><li>setrange</li><li>setnx</li><li>append</li><li>strlen</li></ul></li><li>多键操作 <ul><li>mset</li><li>msetnx</li><li>mget</li></ul></li><li>数字操作 <ul><li>incr</li><li>decr</li><li>incrby</li><li>decrby</li><li>incrbyfloat</li><li>decrbyfloat</li></ul></li></ul></li><li>外部API操作 <ul><li>jedis</li></ul></li></ul><table><thead><tr><th>命令</th><th>描述</th><th>时间复杂度</th></tr></thead><tbody><tr><td>set key value [ex seconds] [px milliseconds] [nx xx]</td><td>设置值</td><td>O(1)</td></tr><tr><td>get key</td><td>获取值</td><td>O(1)</td></tr><tr><td>del key [key ...]</td><td>删除key</td><td>O(N)(N是键的个数)</td></tr><tr><td>mset key [key value ...]</td><td>批量设置值</td><td>O(N)(N是键的个数)</td></tr><tr><td>mget key [key ...]</td><td>批量获取值</td><td>O(N)(N是键的个数)</td></tr><tr><td>incr key</td><td>将 key 中储存的数字值增一</td><td>O(1)</td></tr><tr><td>decr key</td><td>将 key 中储存的数字值减一</td><td>O(1)</td></tr><tr><td>incrby key increment</td><td>将 key 所储存的值加上给定的增量值（increment）</td><td>O(1)</td></tr><tr><td>decrby key increment key</td><td>所储存的值减去给定的减量值（decrement）</td><td>O(1)</td></tr><tr><td>incrbyfloat key increment</td><td>将 key 所储存的值加上给定的浮点增量值（increment）</td><td>O(1)</td></tr><tr><td>append key value</td><td>如果 key 已经存在并且是一个字符串， APPEND 命令将指定的 value 追加到该 key 原来值（value）的末尾</td><td>O(1)</td></tr><tr><td>strlen key</td><td>返回 key 所储存的字符串值的长度。</td><td>O(1)</td></tr><tr><td>setrange key offset value</td><td>用 value 参数覆写给定 key 所储存的字符串值，从偏移量 offset 开始</td><td>O(1)</td></tr><tr><td>getrange key start end</td><td>返回 key 中字符串值的子字符</td><td>O(N)(N是字符串的长度)</td></tr></tbody></table><h3 id="底层数据结构" tabindex="-1"><a class="header-anchor" href="#底层数据结构" aria-hidden="true">#</a> 底层数据结构</h3><p>底层数据结构为SDS，但是根据保存的数据的类型以及数据长度，分为三种：</p><ul><li>int： 存储的是整数且长度小于20字节</li><li>embstr： 存储的是字符串且长度小于等于44字节</li><li>raw： 存储的是动态字符串，且长度大于44字节且小于512Mb <ul><li>redis 2.+ 是 32 字节</li><li>redis 3.0-4.0 是 39 字节</li><li>redis 5.0 是 44 字节</li></ul></li></ul><h2 id="list" tabindex="-1"><a class="header-anchor" href="#list" aria-hidden="true">#</a> List</h2><p>List的数据结构，适合保存<code>可以重复的、有序的数据集合</code>。</p><h3 id="使用场景-1" tabindex="-1"><a class="header-anchor" href="#使用场景-1" aria-hidden="true">#</a> 使用场景</h3><ul><li>lpush+lpop=Stack（栈）</li><li>lpush+rpop=Queue（队列）</li><li>lpush+ltrim=Capped Collection（有限集合）</li><li>lpush+brpop=Message Queue（消息队列）</li></ul><h3 id="命令示例-1" tabindex="-1"><a class="header-anchor" href="#命令示例-1" aria-hidden="true">#</a> 命令示例</h3><ul><li>lpush</li><li>lrange</li><li>rpush</li><li>lpop</li><li>rpop</li><li>lindex</li><li>linsert</li><li>lset</li><li>ltrim</li><li>llen</li><li>lrem</li></ul><table><thead><tr><th>命令</th><th>描述</th><th>时间复杂度</th></tr></thead><tbody><tr><td>BLPOP key [key …] timeout</td><td>删除，并获得该列表中的第一元素，或阻塞，直到有一个可用</td><td>O(1)</td></tr><tr><td>BRPOP key [key …] timeout</td><td>删除，并获得该列表中的最后一个元素，或阻塞，直到有一个可用</td><td>O(1)</td></tr><tr><td>BRPOPLPUSH source destination timeout</td><td>弹出一个列表的值，将它推到另一个列表，并返回它;或阻塞，直到有一个可用</td><td>O(1)</td></tr><tr><td>LINDEX key index</td><td>获取一个元素，通过其索引列表</td><td>O(N)</td></tr><tr><td>LINSERT key BEFORE AFTER pivot value</td><td>在列表中的另一个元素之前或之后插入一个元素</td><td>O(N)</td></tr><tr><td>LLEN key</td><td>获得队列(List)的长度</td><td>O(1)</td></tr><tr><td>LPOP key</td><td>从队列的左边出队一个元素</td><td>O(1)</td></tr><tr><td>LPUSH key value [value …]</td><td>从队列的左边入队一个或多个元素</td><td>O(1)</td></tr><tr><td>LPUSHX key value</td><td>当队列存在时，从队到左边入队一个元素</td><td>O(1)</td></tr><tr><td>LRANGE key start stop</td><td>从列表中获取指定返回的元素</td><td>O(S+N)</td></tr><tr><td>LREM key count value</td><td>从列表中删除元素</td><td>O(N)</td></tr><tr><td>LSET key index value</td><td>设置队列里面一个元素的值</td><td>O(N)</td></tr><tr><td>LTRIM key start stop</td><td>修剪到指定范围内的清单</td><td>O(N)</td></tr><tr><td>RPOP key</td><td>从队列的右边出队一个元</td><td>O(1)</td></tr><tr><td>RPOPLPUSH source destination</td><td>删除列表中的最后一个元素，将其追加到另一个列表</td><td>O(1)</td></tr><tr><td>RPUSH key value [value …]</td><td>从队列的右边入队一个元素</td><td>O(1)</td></tr><tr><td>RPUSHX key value</td><td>从队列的右边入队一个元素，仅队列存在时有效</td><td>O(1)</td></tr></tbody></table><h3 id="底层数据结构-1" tabindex="-1"><a class="header-anchor" href="#底层数据结构-1" aria-hidden="true">#</a> 底层数据结构</h3><ul><li>Redis3.2版本以前： 内部编码方式有两种 <ul><li>ziplist（压缩列表）：当列表的元素个数小于 <code>list-max-ziplist-entries</code> 配置（<code>默认512个</code>），同时列表中每个元素的值都小于 <code>list-max-ziplist-value</code> 配置时（<code>默认64字节</code>），Redis会选用ziplist来作为列表的内部实现来减少内存的使用。</li><li>linkedlist（链表）：当列表类型无法满足ziplist的条件时，Redis会使用linkedlist作为列表的内部实现。</li></ul></li><li>Redis3.2版本开始， 使用 quicklist 代替了 ziplist 和 linkedlist</li><li>Redis 5.0 设计了新的数据结构 listpack，沿用了压缩列表紧凑型的内存布局，最终在最新的 Redis 版本，将 Hash 对象和 Zset 对象的底层数据结构实现之一的压缩列表，替换成由 listpack 实现</li></ul><h2 id="set" tabindex="-1"><a class="header-anchor" href="#set" aria-hidden="true">#</a> Set</h2><p>保存不可重复的、无序的元素集合。</p><h3 id="使用场景-2" tabindex="-1"><a class="header-anchor" href="#使用场景-2" aria-hidden="true">#</a> 使用场景</h3><ul><li>任何用来去重的场景和保证数据唯一性的场景</li><li>求交差并补集合</li><li>我关注的、关注我的</li></ul><h3 id="命令示例-2" tabindex="-1"><a class="header-anchor" href="#命令示例-2" aria-hidden="true">#</a> 命令示例</h3><ul><li>sadd</li><li>smembers</li><li>scard</li><li>sismember</li><li>smove</li><li>srem</li><li>spop</li><li>srandmember</li><li>sinter</li><li>sinterstore</li><li>sunion</li><li>sunionstore</li><li>sdiff</li><li>sdiffstore</li></ul><table><thead><tr><th>命令</th><th>描述</th><th>时间复杂度</th></tr></thead><tbody><tr><td>SADD key member [member …]</td><td>添加一个或者多个元素到集合(set)里</td><td>O(N)</td></tr><tr><td>SCARD key</td><td>获取集合里面的元素数量</td><td>O(1)</td></tr><tr><td>SDIFF key [key …]</td><td>获得队列不存在的元素</td><td>O(N)</td></tr><tr><td>SDIFFSTORE destination key [key …]</td><td>获得队列不存在的元素，并存储在一个关键的结果集</td><td>O(N)</td></tr><tr><td>SINTER key [key …]</td><td>获得两个集合的交集</td><td>O(N*M)</td></tr><tr><td>SINTERSTORE destination key [key …]</td><td>获得两个集合的交集，并存储在一个关键的结果集</td><td>O(N*M)</td></tr><tr><td>SISMEMBER key member</td><td>确定一个给定的值是一个集合的成员</td><td>O(1)</td></tr><tr><td>SMEMBERS key</td><td>获取集合里面的所有元素</td><td>O(N)</td></tr><tr><td>SMOVE source destination member</td><td>移动集合里面的一个元素到另一个集合</td><td>O(1)</td></tr><tr><td>SPOP key [count]</td><td>删除并获取一个集合里面的元素</td><td>O(1)</td></tr><tr><td>SRANDMEMBER key [count]</td><td>从集合里面随机获取一个元素</td><td></td></tr><tr><td>SREM key member [member …]</td><td>从集合里删除一个或多个元素</td><td>O(N)</td></tr><tr><td>SUNION key [key …]</td><td>添加多个set元素</td><td>O(N)</td></tr><tr><td>SUNIONSTORE destination key [key …]</td><td>合并set元素，并将结果存入新的set里面</td><td>O(N)</td></tr><tr><td>SSCAN key cursor [MATCH pattern] [COUNT count]</td><td>迭代set里面的元素</td><td>O(1)</td></tr></tbody></table><h3 id="底层数据结构-2" tabindex="-1"><a class="header-anchor" href="#底层数据结构-2" aria-hidden="true">#</a> 底层数据结构</h3><ul><li><code>intset</code> ： 当集合中的元素都是整数且元素个数小于 <code>set-maxintset-entries</code> 配置（默认512个）时，Redis会选用intset来作为集合的内部实现，从而减少内存的使用。</li><li><code>hashtable</code> ： 集合类型无法满足intset的条件时，Redis会使用hashtable作为集合的内部实现。</li></ul><h2 id="sortedset-zset" tabindex="-1"><a class="header-anchor" href="#sortedset-zset" aria-hidden="true">#</a> SortedSet（zset）</h2><p>保存<code>不可重复、具有顺序</code>的元素集合，保存的元素不能重复，但是分数可以重复。</p><h3 id="使用场景-3" tabindex="-1"><a class="header-anchor" href="#使用场景-3" aria-hidden="true">#</a> 使用场景</h3><ul><li>微博中的热搜等场景</li></ul><h3 id="命令示例-3" tabindex="-1"><a class="header-anchor" href="#命令示例-3" aria-hidden="true">#</a> 命令示例</h3><ul><li>zadd</li><li>zrange</li><li>zrem</li><li>zscore</li><li>zrangebyscore</li><li>zrank</li><li>zcard</li><li>zcount</li><li>zincrby</li><li>zrevrank</li><li>zremrangebyrank</li><li>zremrangebyscore</li><li>zinterstore</li><li>zunionstore</li></ul><table><thead><tr><th>命令</th><th>描述</th><th>时间复杂度</th></tr></thead><tbody><tr><td>BZPOPMAX key [key …] timeout</td><td>从一个或多个排序集中删除并返回得分最高的成员，或阻塞，直到其中一个可用为止</td><td>O(log(N))</td></tr><tr><td>BZPOPMIN key [key …] timeout</td><td>从一个或多个排序集中删除并返回得分最低的成员，或阻塞，直到其中一个可用为止</td><td>O(log(N))</td></tr><tr><td>ZADD key [NXXX] [CH] [INCR] score member [score member …]</td><td>添加到有序set的一个或多个成员，或更新的分数，如果它已经存在</td><td>O(log(N))</td></tr><tr><td>ZCARD key</td><td>获取一个排序的集合中的成员数量</td><td>O(1)</td></tr><tr><td>ZCOUNT key min max</td><td>返回分数范围内的成员数量</td><td>O(log(N))</td></tr><tr><td>ZINCRBY key increment member</td><td>增量的一名成员在排序设置的评分</td><td>O(log(N))</td></tr><tr><td>ZINTERSTORE</td><td>相交多个排序集，导致排序的设置存储在一个新的关键</td><td>O(NK)+O(Mlog(M))</td></tr><tr><td>ZLEXCOUNT key min max</td><td>返回成员之间的成员数量</td><td>O(log(N))</td></tr><tr><td>ZPOPMAX key [count]</td><td>删除并返回排序集中得分最高的成员</td><td>O(log(N)*M)</td></tr><tr><td>ZPOPMIN key [count]</td><td>删除并返回排序集中得分最低的成员</td><td>O(log(N)*M)</td></tr><tr><td>ZRANGE key start stop [WITHSCORES]</td><td>根据指定的index返回，返回sorted set的成员列表</td><td>O(log(N)+M)</td></tr><tr><td>ZRANGEBYLEX key min max [LIMIT offset count]</td><td>返回指定成员区间内的成员，按字典正序排列, 分数必须相同。</td><td>O(log(N)+M)</td></tr><tr><td>ZREVRANGEBYLEX key max min [LIMIT offset count]</td><td>返回指定成员区间内的成员，按字典倒序排列, 分数必须相同</td><td>O(log(N)+M)</td></tr><tr><td>ZRANGEBYSCORE key min max [WITHSCORES] [LIMIT offset count]</td><td>返回有序集合中指定分数区间内的成员，分数由低到高排序。</td><td>O(log(N)+M)</td></tr><tr><td>ZRANK key member</td><td>确定在排序集合成员的索引</td><td>O(log(N))</td></tr><tr><td>ZREM key member [member …]</td><td>从排序的集合中删除一个或多个成员</td><td>O(M*log(N))</td></tr><tr><td>ZREMRANGEBYLEX key min max</td><td>删除名称按字典由低到高排序成员之间所有成员。</td><td>O(log(N)+M)</td></tr><tr><td>ZREMRANGEBYRANK key start stop</td><td>在排序设置的所有成员在给定的索引中删除</td><td>O(log(N)+M)</td></tr><tr><td>ZREMRANGEBYSCORE key min max</td><td>删除一个排序的设置在给定的分数所有成员</td><td>O(log(N)+M)</td></tr><tr><td>ZREVRANGE key start stop [WITHSCORES]</td><td>在排序的设置返回的成员范围，通过索引，下令从分数高到低</td><td>O(log(N)+M)</td></tr><tr><td>ZREVRANGEBYSCORE key max min [WITHSCORES] [LIMIT offset count]</td><td>返回有序集合中指定分数区间内的成员，分数由高到低排序。</td><td>O(log(N)+M)</td></tr><tr><td>ZREVRANK key member</td><td>确定指数在排序集的成员，下令从分数高到低</td><td>O(log(N))</td></tr><tr><td>ZSCORE key member</td><td>获取成员在排序设置相关的比分</td><td>O(1)</td></tr><tr><td>ZUNIONSTORE</td><td>添加多个排序集和导致排序的设置存储在一个新的关键</td><td>O(N)+O(M log(M))</td></tr><tr><td>ZSCAN key cursor [MATCH pattern] [COUNT count]</td><td>迭代sorted sets里面的元素</td><td>O(1)</td></tr></tbody></table><h3 id="底层数据结构-3" tabindex="-1"><a class="header-anchor" href="#底层数据结构-3" aria-hidden="true">#</a> 底层数据结构</h3><ul><li><code>ziplist</code> ： 当数据比较少时，有序集合使用的是 ziplist 存储的，有序集合使用 ziplist 格式存储必须满足以下两个条件： <ul><li>元素个数小于<code>zset-max-ziplist-entries（默认 128个）</code></li><li>所有元素成员的长度要小于<code>zset-max-ziplist-value（默认 64字节）</code></li></ul></li><li><code>skiplist</code> ： 如果不能满足以上两个条件中的任意一个，有序集合将会使用 skiplist 结构进行存储。</li></ul><h2 id="hash" tabindex="-1"><a class="header-anchor" href="#hash" aria-hidden="true">#</a> Hash</h2><h3 id="使用场景-4" tabindex="-1"><a class="header-anchor" href="#使用场景-4" aria-hidden="true">#</a> 使用场景</h3><div class="custom-container note"><p class="custom-container-title">思考题</p><ol><li>redis中存储对象有几种方式？ <ul><li>第一种： <ul><li>set user:1:name zhangsan</li><li>set user:1:age 12</li></ul></li><li>第二种： value为序列化后的对象信息 <ul><li>set user:1 serialize(userInfo)</li></ul></li><li>第三种： 使用字典 <ul><li>hset user:1 name zhangsan age 12</li></ul></li></ul></li><li>假如hashtable数组上的链表元素有很多，那么rehash过程中，这些链表元素是怎么rehash到ht[1]上的？</li><li>hashtable扩容时，为什么 BGSAVE 或 BGREWRITEAOF 命令执行时的负载因子要比没有执行这两个命令时的负载因子大？</li></ol></div><h3 id="命令示例-4" tabindex="-1"><a class="header-anchor" href="#命令示例-4" aria-hidden="true">#</a> 命令示例</h3><ul><li>hset</li><li>hsetnx</li><li>hmset</li><li>hget</li><li>hmget</li><li>hdel</li><li>hincrby</li><li>hkeys</li><li>hvals</li><li>hgetall</li><li>hincrbyfloat</li><li>hexists</li><li>hlen</li></ul><table><thead><tr><th>命令</th><th>描述</th><th>时间复杂度</th></tr></thead><tbody><tr><td>HDEL key field [field …]</td><td>删除一个或多个Hash的field</td><td>O(N) N是被删除的字段数量。</td></tr><tr><td>HEXISTS key field</td><td>判断field是否存在于hash中</td><td>O(1)</td></tr><tr><td>HGET key field</td><td>获取hash中field的值</td><td>O(1)</td></tr><tr><td>HGETALL key</td><td>从hash中读取全部的域和值</td><td>O(N) N是Hash的长度</td></tr><tr><td>HINCRBY key field increment</td><td>将hash中指定域的值增加给定的数字</td><td>O(1)</td></tr><tr><td>HINCRBYFLOAT key field increment</td><td>将hash中指定域的值增加给定的浮点数</td><td>O(1)</td></tr><tr><td>HKEYS key</td><td>获取hash的所有字段</td><td>O(N) N是Hash的长度</td></tr><tr><td>HLEN key</td><td>获取hash里所有字段的数量</td><td>O(1)</td></tr><tr><td>HMGET key field [field …]</td><td>获取hash里面指定字段的值</td><td>O(N) N是请求的字段数</td></tr><tr><td>HMSET key field value [field value …]</td><td>设置hash字段值</td><td>O(N) N是设置的字段数</td></tr><tr><td>HSET key field value</td><td>设置hash里面一个字段的值</td><td>O(1)</td></tr><tr><td>HSETNX key field value</td><td>设置hash的一个字段，只有当这个字段不存在时有效</td><td>O(1)</td></tr><tr><td>HSTRLEN key field</td><td>获取hash里面指定field的长度</td><td>O(1)</td></tr><tr><td>HVALS key</td><td>获得hash的所有值</td><td>O(N) N是Hash的长度</td></tr><tr><td>HSCAN key cursor [MATCH pattern] [COUNT count]</td><td>迭代hash里面的元素</td><td></td></tr></tbody></table><h3 id="底层数据结构-4" tabindex="-1"><a class="header-anchor" href="#底层数据结构-4" aria-hidden="true">#</a> 底层数据结构</h3><ul><li><code>键值对数量小于512【hash-max-ziplist-entries配置（默认512个）】</code> &amp;&amp; <code>所有键值对的key和value的长度都小于64字节【所有值都小于hash-max-ziplist-value配置（默认64字节）】</code> 时使用ziplist；</li><li>否则就使用 hashtable</li></ul><h2 id="bitmap" tabindex="-1"><a class="header-anchor" href="#bitmap" aria-hidden="true">#</a> Bitmap</h2><p>Bitmap即位图，是一串连续的二进制数组（只有0和1），可以通过偏移量定位元素。适用于数据量大且使用二值统计的场景。</p><h3 id="内部实现" tabindex="-1"><a class="header-anchor" href="#内部实现" aria-hidden="true">#</a> 内部实现</h3><p>是基于String类型实现的，只不过是String的值为二进制字节数组。</p><h3 id="适用场景" tabindex="-1"><a class="header-anchor" href="#适用场景" aria-hidden="true">#</a> 适用场景</h3><h4 id="统计考勤" tabindex="-1"><a class="header-anchor" href="#统计考勤" aria-hidden="true">#</a> 统计考勤</h4><p>比如有这么几个业务场景：</p><ol><li>需要统计某一用户在某一月份的出勤情况；</li><li>统计某一用户的全年出勤情况</li></ol><p>具体实现可能是这样的： 以具有月份意义的字符串作为key，然后以这个月份具有的天数作为偏移量，出勤为1，缺勤为0。这样就相当于为每一个用户都创建12个key，每一个key所使用的Bit位不超过31个（一个月份最多有31天），也就是说最多使用365个bit位就可以表示一个用户的全年出勤情况。如下图表示用户id=28的用户全年的出勤情况：</p><p><img src="https://tianqingxiaozhu.oss-cn-shenzhen.aliyuncs.com/blog20230708111911.png" alt="20230708111911" loading="lazy"></p><p>下图表示用户id=32的用户的全年出勤情况：</p><p><img src="https://tianqingxiaozhu.oss-cn-shenzhen.aliyuncs.com/blog20230708111931.png" alt="20230708111931" loading="lazy"></p><p>如，id=13的用户在202206月份的25日出勤了，那么就可以：</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>SETBIT uuid:sign:13:202206 24 1
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>同样地，id=26的用户在202207月份的18日缺勤，则可以记录为：</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>SETBIT uuid:sign:26:202207 17 0
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>那么获取id=20的用户在202209月份8日的出勤情况，则可以使用命令：</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GETBIT uuid:sign:20:202209 7
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>也可以统计id=20的用户在202209月份的出勤天数：</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>BITCOUNT uuid:sign:20:202209
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>甚至可以统计id=100的用户在202206月份的首次打卡情况【1表示弹出第一个元素】：</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>BITPOS uuid:sign:100:202206 1
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>统计某一用户的全年出勤情况，则可以通过分别获取每一月的出勤情况，然后做一个汇总即可。</p><h4 id="统计登陆情况" tabindex="-1"><a class="header-anchor" href="#统计登陆情况" aria-hidden="true">#</a> 统计登陆情况</h4><p>在很多web应用中，有时会遇到要统计用户登陆情况的业务场景，我们就可以把日期作为key，把用户的id作为偏移量。</p><p><img src="https://tianqingxiaozhu.oss-cn-shenzhen.aliyuncs.com/blog20230708094630.png" alt="20230708094630" loading="lazy"></p><p>例如，userid=4的用户在20220521这一天登陆了，就使用下面的命令在Redis中记录一下：</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>SETBIT 20220521 3 1 
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>说明：</p><ul><li>20220521 为key；</li><li>3为偏移量，具有业务意义，表示userid=4的偏移量；</li><li>1为字节数组中的元素，表示登陆；</li></ul><p>同样的，可以使用下面命令获取userid=6的用户在20220522这一天的登陆情况：</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GETBIT 20220522 5 
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>比如统计id=45的用户，在七日内的登陆情况，就相当于统计七个bitmap中偏移量为45的位置上的值，我们只需要把这七个bitmap中偏移量为45的bit值统计出来，然后再创建一个bitmap专门存放这个结果即可实现业务需求。</p><h2 id="hyperloglog" tabindex="-1"><a class="header-anchor" href="#hyperloglog" aria-hidden="true">#</a> HyperLogLog</h2><p>HyperLogLog 是 Redis 2.8.9 版本添加的数据结构，它用于高性能的基数（去重）统计功能，也就是说，这种数据结构可以统计一个集合内所有不重复的元素个数。它的缺点就是存在0.81% 的误差。但是误差可以通过设置辅助计算因子进行降低。</p><h3 id="命令示例-5" tabindex="-1"><a class="header-anchor" href="#命令示例-5" aria-hidden="true">#</a> 命令示例</h3><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>// 添加元素
127.0.0.1:6379&gt; pfadd key &quot;redis&quot;
(integer) 1
127.0.0.1:6379&gt; pfadd key &quot;java&quot; &quot;sql&quot;
(integer) 1

// 统计不重复的元素
127.0.0.1:6379&gt; pfadd key &quot;redis&quot;
(integer) 1
127.0.0.1:6379&gt; pfadd key &quot;sql&quot;
(integer) 1
127.0.0.1:6379&gt; pfadd key &quot;redis&quot;
(integer) 0
127.0.0.1:6379&gt; pfcount key
(integer) 2

// 合并
127.0.0.1:6379&gt; pfadd k &quot;java&quot; &quot;sql&quot;
(integer) 1
127.0.0.1:6379&gt; pfadd k2 &quot;redis&quot; &quot;sql&quot;
(integer) 1
127.0.0.1:6379&gt; pfmerge k3 k k2
OK
127.0.0.1:6379&gt; pfcount k3
(integer) 3

</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h3 id="底层数据结构-5" tabindex="-1"><a class="header-anchor" href="#底层数据结构-5" aria-hidden="true">#</a> 底层数据结构</h3><p>HyperLogLog存储数据时，相当于使用一个或多个hash算法，把计算出的hash值保存成类似位图的数据结构，然后在使用时，只需要利用同样的算法计算出所有的key即可。使用位图的方式让Redis使用更少的内存空间来存储大量的key。这种方式比使用set、list等要非常节省空间。</p><h3 id="适用场景-1" tabindex="-1"><a class="header-anchor" href="#适用场景-1" aria-hidden="true">#</a> 适用场景</h3><p>可以用于统计诸如PV、UV的业务场景中。</p><h2 id="geo" tabindex="-1"><a class="header-anchor" href="#geo" aria-hidden="true">#</a> GEO</h2><p>可以<code>保存地理位置信息</code>并<code>对地理位置信息进行操作</code>，是3.2以后提供的新特性。可以完成类似于“搜索附近”的功能，如在地图上定位到某一个景点，GEO这种数据结构可以完成搜索附近美食的功能。</p><h3 id="命令示例-6" tabindex="-1"><a class="header-anchor" href="#命令示例-6" aria-hidden="true">#</a> 命令示例</h3><ul><li>geoadd</li><li>geopos</li><li>geodist</li><li>georadius</li><li>geohash</li><li>zrem</li></ul><h3 id="底层数据结构-6" tabindex="-1"><a class="header-anchor" href="#底层数据结构-6" aria-hidden="true">#</a> 底层数据结构</h3><ul><li>并没有设计新的底层数据结构，而是直接使用SortedSet作为底层实现；</li><li>具体实现： <ul><li>先对二维地图做区间划分，并对区间进行编码；之后判断实际的地理位置在哪一个区间上，然后使用这个区间的编码作为SortedSet的权重信息；</li><li>举例说明： 如 某一个地理位置为（112.23E，32.89N），它在划分后的编码为5的区间上，那么就把5作为SortedSet的权重；</li></ul></li></ul><h2 id="stream" tabindex="-1"><a class="header-anchor" href="#stream" aria-hidden="true">#</a> Stream</h2><p>就是Redis实现的一种消息中间件的数据结构。先了解一下消息中间件的概念：</p><div class="custom-container tip"><p class="custom-container-title">消息中间件的准备知识</p><ol><li>为什么会有消息中间件？ 解耦、削峰、异步、高性能；</li><li>有哪些概念？ 消息、生产者、消费者、主题、channel等；</li></ol></div><h3 id="使用redis早期版本作为消息中间件" tabindex="-1"><a class="header-anchor" href="#使用redis早期版本作为消息中间件" aria-hidden="true">#</a> 使用Redis早期版本作为消息中间件</h3><ul><li>发布订阅机制 <ul><li>publish <ul><li>返回0~n的整数，表示有多少个消费者接收到了消息</li></ul></li><li>subscribe <ul><li>可以订阅多个channel</li><li>命令会一直阻塞，等待接收消息</li></ul></li><li>psubscribe <ul><li>可以订阅主题，只能订阅一个主题</li><li>发布订阅模式，这种方式有两个问题 <ul><li>无法持久化消息，Redis重启后，消息会丢失；</li><li>发后即忘的，如果消费者没有收到消息，就会再也接受不到消息了；</li></ul></li></ul></li></ul></li><li>List ： 就是使用lpush+rpop来完成 <ul><li>比发布订阅机制的： <ul><li>优点 <ul><li>可以持久化消息</li><li>可以积压消息</li></ul></li><li>缺点 <ul><li>不能重复消费</li><li>消费时还需要遍历所有的消息列表</li><li>没有主题订阅的功能</li></ul></li></ul></li></ul></li><li>ZSet <ul><li>比发布订阅机制的： <ul><li>优点 <ul><li>支持持久化</li><li>比list查询更方便，可以使用score属性来完成遍历</li></ul></li><li>缺点 <ul><li>不能存储相同消息，也就是消息不能重复</li><li>不能完成消息队列的有序性</li><li>没有弹出功能</li></ul></li></ul></li></ul></li></ul><p>上面这三种方式，都只能保存单值，如果想要保存一个对象，就需要先对其序列化。Redis5.0之后引入Stream，就是为了更加完美的实现消息队列。它具有以下特性：</p><ul><li>支持消息的持久化</li><li>支持自动生成全局唯一id</li><li>支持ack确认消息</li><li>支持消费组模式等</li></ul><h3 id="保存内容-1" tabindex="-1"><a class="header-anchor" href="#保存内容-1" aria-hidden="true">#</a> 保存内容</h3><h3 id="命令示例-7" tabindex="-1"><a class="header-anchor" href="#命令示例-7" aria-hidden="true">#</a> 命令示例</h3><ul><li>xadd</li><li>xread： 循环阻塞读取消息</li><li>xrange</li><li>xlen</li><li>xdel</li><li>del</li><li>xgroup <ul><li>xgroup delconsumer</li><li>xgroup destroy</li></ul></li><li>xreadgroup</li><li>xack</li><li>xpending</li><li>xinfo <ul><li>xinfo stream</li><li>xinfo groups</li><li>xinfo consumers</li></ul></li></ul><ol><li>生产消息</li></ol><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>// 往消息队列中插入消息
&gt; XADD mymsgqueue * name zeanzai 
&quot;1654254953808-0&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>XADD 中的 * 表示让 Redis 为插入的数据自动生成一个全局唯一的 ID</li><li>XADD 中的 name 表示键， zeanzai 表示值</li><li>XADD 的输出结果中，1654254953808为以毫秒为单位计算的当前服务器的时间；-0表示第1条消息信息；</li></ul><ol start="2"><li>消费消息</li></ol><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>// 单个消费者消费
// 消费消息队列中的消息， 消费 1654254953807-0 后续的所有消息
&gt; XREAD STREAMS mymsgqueue 1654254953807-0
1) 1) &quot;mymsgqueue&quot;
   1) 1) 1) &quot;1654254953808-0&quot;
         1) 1) &quot;name&quot;
            1) &quot;zeanzai&quot;

// 阻塞消费消息队列中的消息， $ 表示读取最新的消息
&gt; XREAD BLOCK 10000 STREAMS mymsgqueue $
(nil)
(10.00s)
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><ul><li>XREAD 中的 1654254953807-0 表示从这条信息的下条信息开始消费</li><li>XREAD BLOCK 10000 中的 block 10000 表示在消费时，阻塞10s时间。</li></ul><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>// 多个消费者形成一个消费组进行消费
// 为某一个消息流设置多个消费组，并标识消费消息的位置
// 创建一个名为 group1 的消费组，0-0 表示从第一条消息开始读取。
&gt; XGROUP CREATE mymsgqueue group1 0-0
OK

// 创建一个名为 group2 的消费组，0-0 表示从第一条消息开始读取。
&gt; XGROUP CREATE mymsgqueue group2 0-0
OK

// 让消费组里面的某一个消费者消费消息
// 注意： 一个消息只能由消费者组内的一个消费者消费；但是可以由多个消费组的多个消费者消费；
// 消费组 group1 内的消费者 consumer1 从 mymq 消息队列中读取所有消息的命令如下：
// 命令最后的参数“&gt;”，表示从第一条尚未被消费的消息开始读取。
&gt; XREADGROUP GROUP group1 consumer1 STREAMS mymsgqueue &gt;
1) 1) &quot;mymq&quot;
   2) 1) 1) &quot;1654254953808-0&quot;
         2) 1) &quot;name&quot;
            2) &quot;zeanzai&quot;

</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><ol start="3"><li>消费者确认消费</li></ol><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>&gt; XACK mymsgqueue group2 1654254953808-0
(integer) 1

// 查看某一个消费组已经消费，但是还没有确认的消息列表
&gt; XPENDING mymsgqueue group2
1) (integer) 3
2) &quot;1654254953808-0&quot;  # 表示 group2 中所有消费者读取的消息最小 ID
3) &quot;1654256271337-0&quot;  # 表示 group2 中所有消费者读取的消息最大 ID
4) 1) 1) &quot;consumer1&quot;
      2) &quot;1&quot;
   2) 1) &quot;consumer2&quot;
      2) &quot;1&quot;
   3) 1) &quot;consumer3&quot;
      2) &quot;1&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>消息确认消费的原理： Redis会把每一个消费过的消息保存到PENDING list中，直到消费者使用XACK命令确认消息消费成功。</p><h3 id="stream与主流mq对比" tabindex="-1"><a class="header-anchor" href="#stream与主流mq对比" aria-hidden="true">#</a> Stream与主流MQ对比</h3><p>可从消息的可靠性、持久性、有序性、解决重复消费、高可用、消息积压等方面去理解。</p><ul><li>有序性： 单个消费者时，消费顺序天然有序；多个消费组时，在消费组内有序，消费组间无序；</li><li>持久性： Redis对Stream具有有序性；</li><li>解决重复消费问题： Stream为每一个消息都设置了全局唯一id，保证消息的唯一性，重复消费问题可以通过ack机制及消费端应用自行处理；</li><li>高可用问题（消息丢失问题）： 生产者由生产者端应用自行处理；消息队列则由Redis保证，可能会出现消息丢失问题，因为AOF每秒写盘、主从切换时也可能会丢失部分数据；消费者可以通过确认机制达到高可用性；</li><li>消息积压问题： Stream可以设置固定长度，当消息队列超过最大长度后，redis会删除旧消息数据，这样是有可能造成消息丢失的；</li></ul><p>选择Redis作为消息中间件的应用场景：业务比较简单、对丢失数据不够敏感、且消息积压概率较小，可以使用Redis作为消息中间件。其他情况，还是建议使用专门的消息中间件产品。</p><hr><p><br><br><br><img style="border:1px red solid;display:block;margin:0 auto;" src="https://tianqingxiaozhu.oss-cn-shenzhen.aliyuncs.com/img/qrcode.jpg" alt="微信公众号"></p><!--]--></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/zeanzai/zeanzai.github.io/edit/main/docs/java/middleware/redis/redisobject/redis_values.md" rel="noopener noreferrer" target="_blank" aria-label="编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewbox="0 0 1024 1024" aria-labelledby="edit"><title id="edit" lang="en">edit icon</title><g fill="currentColor"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></g></svg><!--]-->编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">上次编辑于: </span><span class="info">2023/8/17 04:43:51</span></div><div class="meta-item contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: zeanzai.me@gmail.com">zeanzai</span><!--]--><!--]--></div></footer><nav class="page-nav"><a href="/java/middleware/redis/redisobject/redis_value_dsa.html" class="nav-link prev" aria-label="底层数据结构"><div class="hint"><span class="arrow left"></span>上一页</div><div class="link"><!---->底层数据结构</div></a><!----></nav><div class="giscus-wrapper input-top" style="display:block;"><giscus-widget repo="zeanzai/zeanzai.github.io" repoId="R_kgDOI84HVQ" category="Announcements" categoryId="DIC_kwDOI84HVc4CUKFF" lang="zh-CN" theme="light" mapping="pathname" inputPosition="top" reactionsEnabled="1" emitMetadata="0"></giscus-widget></div><!----></main><!--]--><footer class="footer-wrapper"><div class="footer">浪漫骑士的二流键盘</div><div class="copyright">Copyright © 2023 天晴小猪</div></footer></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app.3140fa71.js" defer></script>
  </body>
</html>
